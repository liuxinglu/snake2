var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},lxl;!function(t){var e=function(e){function n(n){var i=e.call(this)||this;return i.hasActivi=!1,i.hasDispos=!1,i.addEventListener(eui.UIEvent.COMPLETE,i.loadComplete,i),i.skinName=t.Tool.callJS("getURL")+n,i.funOnActivity=i.onActivity,i.funDispose=i.dispose,i}return __extends(n,e),n.prototype.loadComplete=function(){var e=this;egret.Tween.get(this).wait(.1).call(function(){e.addEventListener(eui.UIEvent.ADDED_TO_STAGE,e.onActivity,e),e.dispatchEvent(new t.CEvent(t.CEvent.LOAD_SKIN_COMPLETE,e))},this)},n.prototype.onActivity=function(){for(var t=0;t<this.numChildren;t++)this.doAcivity(this.getChildAt(t));this.hasActivi=!0},n.prototype.doAcivity=function(t){if(t.hasOwnProperty("funOnActivity")&&0==t.hasActivi&&t.funOnActivity(),0!=t.numChildren)for(var e=0;e<t.numChildren;e++)this.doAcivity(t.getChildAt(e))},n.prototype.dispose=function(){this.removeEventListener(eui.UIEvent.COMPLETE,this.loadComplete,this),this.removeEventListener(eui.UIEvent.ADDED_TO_STAGE,this.onActivity,this);for(var t=0;t<this.numChildren;t++)this.doDispos(this.getChildAt(t));this.parent.removeChild(this),this.hasDispos=!0},n.prototype.doDispos=function(t){if(t.hasOwnProperty("funDispose")&&0==t.hasDispos&&t.funDispose(),0!=t.numChildren)for(var e=0;e<t.numChildren;e++)this.doDispos(t.getChildAt(e))},n.prototype.createChildren=function(){e.prototype.createChildren.call(this)},n.prototype.removeChildByName=function(t){this.removeChild(this.getChildByName(t))},n.prototype.pop=function(e,n){var i=this;void 0===n&&(n=!1),e.addEventListener(t.CEvent.LOAD_SKIN_COMPLETE,function(){e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=i.stage.stageWidth/2,0==n?e.y=i.stage.stageHeight/2:(e.y=0,e.alpha=0),i.addChild(e),1==n&&egret.Tween.get(e).to({y:i.stage.stageHeight/2,alpha:1},200).to({y:i.stage.stageHeight/2-30},100).to({y:i.stage.stageHeight/2+10},100).to({y:i.stage.stageHeight/2},100)},this)},n}(eui.Component);t.CComponent=e,__reflect(e.prototype,"lxl.CComponent")}(lxl||(lxl={}));var lxl;!function(t){var e;!function(e){var n=function(e){function n(){return e.call(this,"")||this}return __extends(n,e),n.prototype.onOK=function(){close(),null!=this.okHandler&&this.okHandler.call(this.ctx)},n.prototype.onCancel=function(){close(),null!=this.cancelHandler&&this.cancelHandler.call(this.ctx)},n.prototype.show=function(t,e,n,i){this.okHandler=e,this.ctx=i,this.label.text=t,egret.Tween.get(this).to({alpha:1},800,egret.Ease.quintOut)},n.prototype.close=function(){var t=this;egret.Tween.get(this).to({alpha:0},1200,egret.Ease.quintIn).call(function(){t.parent&&t.parent.removeChild(t)})},n.prototype.onActivity=function(){e.prototype.onActivity.call(this),this.btn_ok.addEventListener(t.CEvent.CLICK,this.onOK,this),this.btn_cancel.addEventListener(t.CEvent.CLICK,this.onCancel,this)},n}(t.CComponent);e.ConfirmPanel=n,__reflect(n.prototype,"lxl.ui.ConfirmPanel")}(e=t.ui||(t.ui={}))}(lxl||(lxl={}));var lxl;!function(t){var e;!function(e){var n=function(e){function n(){var t=e.call(this)||this;return t.addEventListener(eui.UIEvent.ADDED_TO_STAGE,t.onActivity,t),t.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,t.dispose,t),t}return __extends(n,e),n.prototype.onActivity=function(){},n.prototype.dispose=function(){for(var t=0;t<this.numChildren;t++)this.getChildAt(t).hasOwnProperty("dispose")&&this.getChildAt(t).dispose();this.parent.removeChild(this)},n.prototype.pop=function(e){var n=this;e.addEventListener(t.CEvent.LOAD_SKIN_COMPLETE,function(){e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=n.stage.stageWidth/2,e.y=n.stage.stageHeight/2,n.addChild(e)},this),this.addChild(e)},n.prototype.removeChildByName=function(t){this.removeChild(this.getChildByName(t))},n}(eui.UILayer);e.CLayer=n,__reflect(n.prototype,"lxl.ui.CLayer")}(e=t.ui||(t.ui={}))}(lxl||(lxl={}));var lxl;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.addListener=function(t,e,n,i,a){void 0===i&&(i=!1),void 0===a&&(a=0),this.addEventListener(t,e,n,i,a)},e.prototype.removeListener=function(t,e,n,i){void 0===i&&(i=!1),this.removeEventListener(t,e,n,i)},e.prototype.dispatch=function(t){return this.dispatchEvent(t)},e.prototype.hasListener=function(t){return this.hasEventListener(t)},e.prototype.willTrigger=function(t){return this.willTrigger(t)},e.prototype.once=function(t,e,n,i,a){return this.once(t,e,n,i,a)},e}(egret.EventDispatcher);t.CDispatcher=e,__reflect(e.prototype,"lxl.CDispatcher")}(lxl||(lxl={}));var lxl;!function(t){var e;!function(e){var n=function(e){function n(){return e.call(this,"")||this}return __extends(n,e),n.prototype.onOK=function(){close(),null!=this.okHandler&&this.okHandler.call(this.ctx)},n.prototype.show=function(t,e,n){this.okHandler=e,this.ctx=n,this.label.text=t,egret.Tween.get(this).to({alpha:1},800,egret.Ease.quintOut)},n.prototype.close=function(){var t=this;egret.Tween.get(this).to({alpha:0},1200,egret.Ease.quintIn).call(function(){t.parent&&t.parent.removeChild(t)})},n.prototype.onActivity=function(){e.prototype.onActivity.call(this),this.btn_ok.addEventListener(t.CEvent.CLICK,this.onOK,this)},n}(t.CComponent);e.AlertPanel=n,__reflect(n.prototype,"lxl.ui.AlertPanel")}(e=t.ui||(t.ui={}))}(lxl||(lxl={}));var app;!function(t){var e=function(){function t(){}return t}();t.GridMap=e,__reflect(e.prototype,"app.GridMap");var n=function(){function t(){}return t}();t.GridSnake=n,__reflect(n.prototype,"app.GridSnake");var i=function(){function t(){this.type="",this.userName="",this.completeNum=0,this.totalNum=0,this.token="",this.gridMap=[],this.gridSnake=[],this.life=0}return t.prototype.dispose=function(){this.gridMap=[],this.gridSnake=[],this.life=0,this.token="",this.userName="",this.completeNum=0,this.totalNum=0},t}();t.ViewData=i,__reflect(i.prototype,"app.ViewData")}(app||(app={}));var lxl;!function(t){var e=function(){function t(){}return t}();t.CEventInit=e,__reflect(e.prototype,"lxl.CEventInit",["EventInit"]);var n=function(t){function e(e,n,i,a,r){void 0===n&&(n=null),void 0===i&&(i=0),void 0===a&&(a=!1),void 0===r&&(r=!1);var s=t.call(this,e,a,r,n)||this;return s._param=n,s}return __extends(e,t),Object.defineProperty(e.prototype,"param",{get:function(){return this._param},enumerable:!0,configurable:!0}),e}(egret.Event);n.CONNECT_SERVER="CEVENT::CONNECT_SERVER",n.CONNECT_FAIL="CEVENT::CONNECT_FAIL",n.LOAD_SKIN_COMPLETE="CEVENT::LOAD_SKIN_COMPLETE",n.LOAD_CONFIG_COMPLETE="CEVENT::LOAD_CONFIG_COMPLETE",n.LOAD_GROUP_COMPLETE="CEVENT::LOAD_GROUP_COMPLETE",n.LOAD_PROGRESS="CEVENT::LOAD_PROGRESS",n.CLICK="CEVENT::CLICK",n.SEL_COMPLETE="CEVENT::SEL_COMPLETE",n.SUCCESS="CEVENT::SUCCESS",n.BACK="CEVENT::BACK",n.UP="CEVENT::UP",n.DOWN="CEVENT::DOWN",n.LEFT="CEVENT::LEFT",n.RIGHT="CEVENT::RIGHT",n.SPACE="CEVENT::SPACE",n.PROTECTE_EYE="CEVENT::PROTECTE_EYE",n.EYE_CHANGE="CEVENT::EYE_CHANGE",n.GET_MESSAGE_FROM_SERVER="CEVENT::GET_MESSAGE_FROM_SERVER",n.GET_MESSAGE="CEVENT::GET_MESSAGE",n.OPEN="CEVENT::OPEN",n.READONLY_CHANGE="READONLY_CHANGE",t.CEvent=n,__reflect(n.prototype,"lxl.CEvent")}(lxl||(lxl={}));var app;!function(t){var e=function(){function t(){}return t.prototype.sendMessageToServer=function(t){var e={action:"publicMessage",data:t};lxl.Tool.callJS("sendMsg",e)},t.prototype.getMessageFromServer=function(t){lxl.CDispatcher.getInstance().dispatch(new lxl.CEvent(lxl.CEvent.GET_MESSAGE_FROM_SERVER,t))},t.prototype.getWordsFromServer=function(){},t}();t.DataHandler=e,__reflect(e.prototype,"app.DataHandler")}(app||(app={}));var lxl;!function(t){var e=t.ui.AlertPanel,n=t.ui.ConfirmPanel,i=function(t){function i(){var e=t.call(this)||this;return e.touchEnabled=!0,e}return __extends(i,t),Object.defineProperty(i.prototype,"alertPanel",{get:function(){return null==this._alertPanel&&(this._alertPanel=new e,this.addChildAt(this._alertPanel,0)),this._alertPanel},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"confirmPanel",{get:function(){return null==this._confirmPanel&&(this._confirmPanel=new n,this.addChildAt(this._confirmPanel,0)),this._confirmPanel},enumerable:!0,configurable:!0}),Object.defineProperty(i,"instance",{get:function(){return null==this._instance&&(this._instance=new i),this._instance},enumerable:!0,configurable:!0}),i.showAlert=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=null),this.instance.alertPanel.show(t,e,n)},i.showConfirm=function(t,e,n,i){void 0===n&&(n=null),void 0===i&&(i=null),this.instance.confirmPanel.show(t,e,n,i)},i}(t.ui.CLayer);t.Alert=i,__reflect(i.prototype,"lxl.Alert")}(lxl||(lxl={}));var lxl;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.loadConfig=function(t,e){RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this._configComplete,this),RES.loadConfig(t,e)},n.prototype._configComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this._configComplete,this),this.dispatch(new t.CEvent(t.CEvent.LOAD_CONFIG_COMPLETE,e))},n.prototype.loadGroup=function(t){RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this._onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this._onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this._onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this._onItemLoadError,this),RES.loadGroup(t)},n.prototype._onResourceLoadComplete=function(e){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this._onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this._onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this._onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this._onItemLoadError,this),this.dispatch(new t.CEvent(t.CEvent.LOAD_GROUP_COMPLETE,e))},n.prototype.getRes=function(t){return RES.getRes(t)},n.prototype.getResAsync=function(t,e,n){RES.getResAsync(t,e,n)},n.prototype.getResByUrl=function(t,e,n,i){var a=new egret.URLLoader;a.addEventListener(egret.Event.COMPLETE,e,n),a.dataFormat=i;var r=new egret.URLRequest(t);a.load(r)},n.prototype._onResourceLoadError=function(e){t.logs.log("Group:"+e.groupName+"加载失败"),this._onResourceLoadComplete(e)},n.prototype._onItemLoadError=function(e){t.logs.log("URL:"+e.resItem.url+" 加载出错")},n.prototype._onResourceProgress=function(e){this.dispatch(new t.CEvent(t.CEvent.LOAD_PROGRESS,e))},n.prototype.getMovieClip=function(t,e,n){var i=RES.getRes(t),a=RES.getRes(e),r=new egret.MovieClipDataFactory(i,a),s=new egret.MovieClip(r.generateMovieClipData(n));return s},n.prototype.getMovieClipAsync=function(e,n,i,a,r){var s,o,l,h=0,c=function(){if(h++,2==h){var t=new egret.MovieClipDataFactory(o,s);l=new egret.MovieClip(t.generateMovieClipData(i)),a.call(r,l)}};this.getResByUrl(t.Config.MC_PATH+n,function(t){s=t.currentTarget.data,c()},this,egret.URLLoaderDataFormat.TEXTURE),this.getResByUrl(t.Config.MC_PATH+n,function(t){o=JSON.parse(t.currentTarget.data),c()},this,egret.URLLoaderDataFormat.TEXT)},n}(t.CDispatcher);t.ResManager=e,__reflect(e.prototype,"lxl.ResManager")}(lxl||(lxl={}));var lxl;!function(t){var e=function(){function e(){this.resManager=new t.ResManager}return e.prototype.connectServer=function(){this.dataManager=new t.DataManager,this.dataManager.addListener(t.CEvent.CONNECT_SERVER,this.connectServerComplete,this)},e.prototype.connectServerComplete=function(t){},e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e}();t.GlobalData=e,__reflect(e.prototype,"lxl.GlobalData")}(lxl||(lxl={}));var lxl;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.isThemeLoadEnd=!1,t.isResourceLoadEnd=!1,t}return __extends(n,e),n.prototype.onActivity=function(){e.prototype.onActivity.call(this),this.stage.scaleMode=egret.StageScaleMode.NO_SCALE,this.root=new t.ui.CLayer,this.shape=new egret.Shape,this._logo=new eui.Image;var n=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",n),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.addEventListener(egret.Event.RESIZE,this._resizeHandler,this),Res.addListener(t.CEvent.LOAD_CONFIG_COMPLETE,this._conConfigComplete,this),this.preURL=t.Tool.callJS("getURL"),Res.loadConfig(this.preURL+"resource/default.res.json",this.preURL+"resource/")},n.prototype._conConfigComplete=function(e){Res.removeListener(t.CEvent.LOAD_CONFIG_COMPLETE,this._conConfigComplete,this);var n=new eui.Theme(this.preURL+"resource/default.thm.json",this.stage);n.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),Res.addListener(t.CEvent.LOAD_GROUP_COMPLETE,this._onResourceLoadComplete,this),Res.loadGroup("preload")},n.prototype._resizeHandler=function(t){this.shape.graphics.clear(),this.shape.graphics.beginFill(10053120),this.shape.graphics.drawRect(0,0,this.width,this.height),this.shape.graphics.endFill()},n.prototype.onThemeLoadComplete=function(t){this.isThemeLoadEnd=!0,this.createScene()},n.prototype._onResourceLoadComplete=function(e){"preload"==e.data.groupName?(this.loading=new t.LoadingUI,this.loading.width=this.width,this.loading.height=this.height,this.loading.createView(),this.stage.addChild(this.loading),Res.addListener(t.CEvent.LOAD_PROGRESS,this._onResourceProgress,this),Res.loadGroup("main")):egret.Tween.get(this.loading).to({alpha:0},1e3).call(this.resourceComplete,this)},n.prototype.resourceComplete=function(){this.stage.removeChild(this.loading),this.isResourceLoadEnd=!0,this.createScene(),Res.removeListener(t.CEvent.LOAD_GROUP_COMPLETE,this._onResourceLoadComplete,this)},n.prototype._onResourceProgress=function(t){this.loading.setProgress(t.data.itemsLoaded,t.data.itemsTotal)},n.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&(this.start(),this.root.delegate=this,this.stage.addChild(this.root),this._logo.source="img_logo_png",this._logo.x=10,this._logo.y=10,this.stage.addChild(this._logo),"web"==egret.Capabilities.runtimeType&&(document.onkeydown=this.keyDownHandler),this.shape.graphics.beginFill(10053120),this.shape.graphics.drawRect(0,0,this.width,this.height),this.shape.graphics.endFill(),this.shape.alpha=0,this.shape.visible=!1,this.stage.addChild(this.shape),t.Toast.getInstance().init(this,Res.getRes("full1_png")),t.CDispatcher.getInstance().addListener(t.CEvent.EYE_CHANGE,this.changeModel,this))},n.prototype.keyDownHandler=function(e){switch(e.keyCode){case 32:t.CDispatcher.getInstance().dispatch(new t.CEvent(t.CEvent.SPACE,"space"));break;case 37:t.CDispatcher.getInstance().dispatch(new t.CEvent(t.CEvent.LEFT,"left"));break;case 38:t.CDispatcher.getInstance().dispatch(new t.CEvent(t.CEvent.UP,"up"));break;case 39:t.CDispatcher.getInstance().dispatch(new t.CEvent(t.CEvent.RIGHT,"right"));break;case 40:t.CDispatcher.getInstance().dispatch(new t.CEvent(t.CEvent.DOWN,"down"))}},n.prototype.changeModel=function(e){var n=this;0==this.shape.visible?(this.shape.alpha=0,this.shape.visible=!0,egret.Tween.get(this.shape).to({alpha:.35},1e3,egret.Ease.quadOut).call(function(){t.CDispatcher.getInstance().dispatch(new t.CEvent(t.CEvent.PROTECTE_EYE,1))})):egret.Tween.get(this.shape).to({alpha:0},1e3,egret.Ease.quintIn).call(function(){n.shape.visible=!1,t.CDispatcher.getInstance().dispatch(new t.CEvent(t.CEvent.PROTECTE_EYE,0))})},n.prototype.start=function(){},n}(t.ui.CLayer);t.Application=e,__reflect(e.prototype,"lxl.Application")}(lxl||(lxl={}));var app;!function(t){var e=function(){function e(){this.arrSnakeParts=[],this.arrTargets=[],this.curBattle=0,this._lastLife=3,this.snakeLens=[3,4,5,5,6],this.targetsLens=[8,12,12,16,16],this.timeNum=500,this.areaX=161,this.areaY=79,this.areaW=816,this.areaH=480,this.scaleGrid=.8,this.teacherAreaX=139,this.teacherAreaY=67,this.viewData=new t.ViewData,this.battleTargets=[[{en:"cat",cn:"猫"},{en:"dog",cn:"狗"},{en:"god",cn:"上帝"},{en:"car",cn:"汽车"},{en:"fat",cn:"胖"},{en:"one",cn:"一"},{en:"two",cn:"二"},{en:"sad",cn:"悲伤"}],[{en:"edge",cn:"边缘"},{en:"girl",cn:"女孩"},{en:"hair",cn:"头发"},{en:"lake",cn:"湖"},{en:"desk",cn:"桌子"},{en:"bike",cn:"自行车"},{en:"ball",cn:"球"},{en:"foot",cn:"脚"},{en:"door",cn:"门"}],[{en:"flash",cn:"闪动"},{en:"floor",cn:"地板"},{en:"heart",cn:"心脏"},{en:"blood",cn:"血液"},{en:"apple",cn:"苹果"},{en:"eagle",cn:"鹰"},{en:"email",cn:"电子邮件"},{en:"image",cn:"图片"},{en:"mouse",cn:"老鼠"}],[{en:"flash",cn:"闪动"},{en:"floor",cn:"地板"},{en:"heart",cn:"心脏"},{en:"blood",cn:"血液"},{en:"apple",cn:"苹果"},{en:"eagle",cn:"鹰"},{en:"email",cn:"电子邮件"},{en:"image",cn:"图片"},{en:"mouse",cn:"老鼠"}],[{en:"family",cn:"家庭"},{en:"dinner",cn:"晚饭"},{en:"winter",cn:"冬天"},{en:"winner",cn:"胜者"}]],this._trueObj={},this._trueTargets=[],this.studentsList=[],this.readOnly=!0,this.dataHandler=new t.DataHandler,lxl.CDispatcher.getInstance().addListener(lxl.CEvent.GET_MESSAGE_FROM_SERVER,this.getMessageHandler,this)}return Object.defineProperty(e.prototype,"lastLife",{get:function(){return this._lastLife},set:function(t){this._lastLife=t,this.viewData.life=t,lxl.CDispatcher.getInstance().dispatch(new lxl.CEvent(e.CHANGE_LIFE))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trueTargets",{get:function(){return this._trueTargets},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trueObj",{get:function(){return this._trueObj},enumerable:!0,configurable:!0}),e.prototype.getMessageHandler=function(t){lxl.logs.log("e:"+t.param.toString());var e=lxl.Tool.callJS("getInfoToken");if("COORDINATOR"==e._userRole)for(var n=0;n<this.studentsList.length;n++){if(this.studentsList[n].token==t.param.token){this.studentsList[n]=t.param,lxl.CDispatcher.getInstance().dispatch(new lxl.CEvent(lxl.CEvent.GET_MESSAGE));break}n==this.studentsList.length-1&&(this.studentsList.push(t.param),lxl.CDispatcher.getInstance().dispatch(new lxl.CEvent(lxl.CEvent.GET_MESSAGE)))}else"show"==t.param.type?(0==this.readOnly&&(this.readOnly=!0,lxl.CDispatcher.getInstance().dispatch(new lxl.CEvent(lxl.CEvent.READONLY_CHANGE))),lxl.CDispatcher.getInstance().dispatch(new lxl.CEvent(lxl.CEvent.GET_MESSAGE,t.param))):"normal"==t.param.type&&1==this.readOnly&&(this.readOnly=!1,lxl.CDispatcher.getInstance().dispatch(new lxl.CEvent(lxl.CEvent.READONLY_CHANGE)))},e.prototype.createTarget=function(){var e=new t.SnakeTarget;return e},e.prototype.createPart=function(){var e=new t.SnakePart;return e},e.prototype.genTargets=function(){this.arrTargets=[];for(var e=0;e<this.targetsLens[this.curBattle];e++){var n=this.createTarget(),i=this.getRandomPos(),a=new t.GridMap;if(a.loc_x=(i.x-Snake.areaX)/lxl.Config.GRID_SIZE,a.loc_y=(i.y-Snake.areaY)/lxl.Config.GRID_SIZE,null!=this._trueTargets[e])n.x=i.x,n.y=i.y,n.setTarget(this._trueTargets[e],this.areaW,this.areaH),this.arrTargets.push(n),a.value=this._trueTargets[e],a.isTarget=!0;else{n.x=i.x,n.y=i.y;var r=String.fromCharCode(97+Math.floor(26*Math.random()));n.setTarget(r,this.areaW,this.areaH),this.arrTargets.push(n),a.value=r.toString(),a.isTarget=!1}this.viewData.gridMap.push(a)}var s=lxl.Tool.callJS("getInfoToken");this.viewData.token=s._loginToken,this.viewData.userName=s._userName,this.viewData.totalNum=this.battleTargets.length,this.viewData.completeNum=this.curBattle+1},e.prototype.getRandomPos=function(){for(var t=Snake.areaX+Math.floor(Math.random()*(this.areaW/lxl.Config.GRID_SIZE))*lxl.Config.GRID_SIZE,e=Snake.areaY+Math.floor(Math.random()*(this.areaH/lxl.Config.GRID_SIZE))*lxl.Config.GRID_SIZE,n=new egret.Point(t,e),i=0;i<this.arrSnakeParts.length;i++){if(this.arrSnakeParts[i].x==t){n=this.getRandomPos();break}for(var a=0;a<this.arrTargets.length;a++)if(this.arrTargets[a].x==t&&this.arrTargets[a].y==e){n=this.getRandomPos();break}if(this.arrSnakeParts[i].x!=t&&i==this.arrSnakeParts.length-1)return n}return n},e.prototype.createSnake=function(){this.arrSnakeParts=[];var e=this.battleTargets[this.curBattle][Math.floor(Math.random()*this.battleTargets[this.curBattle].length)];this._trueObj=e,this._trueTargets=this._trueObj.en.split("");for(var n=this.areaY+Math.floor(10*Math.random())*lxl.Config.GRID_SIZE,i=0;i<this.snakeLens[this.curBattle];i++){var a=this.createPart(),r=new t.GridSnake;r.loc_x=i,r.loc_y=(n-this.areaY)/lxl.Config.GRID_SIZE,r.dir="right",a.x=this.areaX+lxl.Config.GRID_SIZE*i,a.y=n,i==this.snakeLens[this.curBattle]-1?(a.value=this._trueObj.cn,r.isHead=!0):r.isHead=!1,this.arrSnakeParts.push(a),this.viewData.gridSnake.push(r)}this.viewData.life=3},e.prototype.resetSnake=function(){var e=this.areaY+Math.floor(10*Math.random())*lxl.Config.GRID_SIZE;this.viewData.gridSnake=[];for(var n=0;n<this.arrSnakeParts.length;n++){this.arrSnakeParts[n].y=e,this.arrSnakeParts[n].x=this.areaX+lxl.Config.GRID_SIZE*n;var i=new t.GridSnake;i.loc_x=n,i.loc_y=(e-this.areaY)/lxl.Config.GRID_SIZE,i.dir="right",n==this.snakeLens[this.curBattle]-1?i.isHead=!0:i.isHead=!1,this.viewData.gridSnake.push(i)}},e.getInstance=function(){return null==this._snake&&(this._snake=new e),this._snake},e}();e.CHANGE_LIFE="SNAKEMANAGER::CHANGE_LIFE",t.SnakeManager=e,__reflect(e.prototype,"app.SnakeManager")}(app||(app={}));var app;!function(t){var e=function(t){function e(){return t.call(this,lxl.Config.SKIN_PATH+"StudentItemViewSkin.exml")||this}return __extends(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!0,configurable:!0}),e.prototype.updateData=function(){this.lab_name.text=this._data.userName,this.progress.maximum=this._data.totalNum,this.progress.value=this._data.completeNum},e.prototype.onActivity=function(){t.prototype.onActivity.call(this)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(lxl.CComponent);t.StudentItemView=e,__reflect(e.prototype,"app.StudentItemView")}(app||(app={}));var app;!function(t){var e=function(t){function e(){var e=t.call(this,lxl.Config.SKIN_PATH+"SnakeTarget.exml")||this;return e.value="",e.i=0,e.width=lxl.Config.GRID_SIZE,e.height=lxl.Config.GRID_SIZE,e}return __extends(e,t),e.prototype.onActivity=function(){t.prototype.onActivity.call(this),this.lab_num.text=this.value.toString()},e.prototype.setTarget=function(t,e,n){this.value=t,void 0!=this.lab_num&&(this.lab_num.text=t.toString())},e}(lxl.CComponent);t.SnakeTarget=e,__reflect(e.prototype,"app.SnakeTarget")}(app||(app={}));var app;!function(t){var e=function(e){function n(){var t=e.call(this,lxl.Config.SKIN_PATH+"TeacherWatchView.exml")||this;return t.svList=[],t.arrSnakeParts=[],t.arrTargets=[],t}return __extends(n,e),n.prototype.onActivity=function(){e.prototype.onActivity.call(this),lxl.CDispatcher.getInstance().addListener(lxl.CEvent.GET_MESSAGE,this._updateData,this)},n.prototype._updateData=function(e){for(var n,i=this,a=0;a<Snake.studentsList.length;a++){for(var r=0;r<this.svList.length;r++)if(this.svList[r].data.token==Snake.studentsList[a].token){this.svList[r].data=Snake.studentsList[a];break}n=new t.StudentItemView,n.name=Snake.studentsList[a].token,n.data=Snake.studentsList[a],n.addEventListener(lxl.CEvent.LOAD_SKIN_COMPLETE,function(){i.svList.push(n)},this)}for(var a=0;a<this.svList.length;a++)this.scrollGroup.getChildByName(this.svList[a].name)?this.scrollGroup.getChildByName(this.svList[a].name).updateData():(this.scrollGroup.addChild(this.svList[a]),this.svList[a].addEventListener(egret.TouchEvent.TOUCH_TAP,this._clickItemHandler,this));this._curSelStudent&&this._updateTeacherView(this._curSelStudent,"cur")},n.prototype._clickItemHandler=function(t){this._curSelStudent=t.target.data,this._updateTeacherView(this._curSelStudent,"new")},n.prototype._updateTeacherView=function(t,e){this.createSnakeOrMove(t.gridSnake),"new"==e?this.createTargets(t.gridMap,!0):"cur"==e&&this.createTargets(t.gridMap,!1)},n.prototype.createSnakeOrMove=function(t){if(this.arrSnakeParts.length!=t.length){for(var e=0;e<this.arrSnakeParts.length;e++)this.g.removeChild(this.arrSnakeParts[e]);this.arrSnakeParts=[];for(var n=0;n<t.length;n++){var i=Snake.createPart();i.x=Snake.teacherAreaX+Math.floor(lxl.Config.GRID_SIZE*t[n].loc_x*Snake.scaleGrid),i.y=Snake.teacherAreaY+Math.floor(t[n].loc_y*lxl.Config.GRID_SIZE*Snake.scaleGrid),this.arrSnakeParts.push(i)}for(var a=0;a<this.arrSnakeParts.length;a++)this.g.addChild(this.arrSnakeParts[a])}else for(var n=0;n<t.length;n++)this.arrSnakeParts[n].x=Snake.teacherAreaX+Math.floor(lxl.Config.GRID_SIZE*t[n].loc_x*Snake.scaleGrid),this.arrSnakeParts[n].y=Snake.teacherAreaY+Math.floor(t[n].loc_y*lxl.Config.GRID_SIZE*Snake.scaleGrid)},n.prototype.createTargets=function(t,e){if(1==e){for(var n=0;n<this.arrTargets.length;n++)this.g.removeChild(this.arrTargets[n]);this.arrTargets=[];for(var n=0;n<t.length;n++){var i=Snake.createTarget();i.x=t[n].loc_x*Snake.scaleGrid*lxl.Config.GRID_SIZE,i.y=t[n].loc_y*Snake.scaleGrid*lxl.Config.GRID_SIZE,i.setTarget(t[n].value,Snake.areaW,Snake.areaH),i.vd=t[n],this.arrTargets.push(i)}for(var n=0;n<this.arrTargets.length;n++)this.g.addChild(this.arrTargets[n])}else for(var n=0;n<this.arrTargets.length;n++)for(var a=0;a<t.length;a++)if(this.arrTargets[n].value==t[a].value&&this.arrTargets[n].vd.loc_x==t[a].loc_x&&this.arrTargets[n].vd.loc_y==t[a].loc_y)return void this.g.removeChild(this.arrTargets[n])},n.prototype.dispose=function(){e.prototype.dispose.call(this),lxl.CDispatcher.getInstance().removeListener(lxl.CEvent.GET_MESSAGE,this._updateData,this);for(var t=0;t<this.scrollGroup.numChildren;t++)this.svList[t].removeEventListener(egret.TouchEvent.TOUCH_TAP,this._clickItemHandler,this)},n}(lxl.CComponent);t.TeachWatchView=e,__reflect(e.prototype,"app.TeachWatchView")}(app||(app={}));var app;!function(t){var e=function(e){function n(){return e.call(this,lxl.Config.SKIN_PATH+"DlgWinSkin.exml")||this}return __extends(n,e),n.prototype.onActivity=function(){e.prototype.onActivity.call(this);var t;t=new egret.Shape,t.graphics.beginFill(0,.4),t.graphics.drawRect(0,0,this.width,this.height),t.graphics.endFill(),this.addChildAt(t,0),this.btn_jixu.addEventListener(lxl.CEvent.CLICK,this._closeHandler,this),this.btn_again.addEventListener(lxl.CEvent.CLICK,this._close2Handler,this),this.btn_help.addEventListener(lxl.CEvent.CLICK,this._helpHandler,this),this.btn_zhishi.addEventListener(lxl.CEvent.CLICK,this._knowledgeHandler,this),this.btn_huyan.addEventListener(lxl.CEvent.CLICK,this._huyanHandler,this),this._sound=Res.getRes("win_mp3"),this._sound.play(0,1),4==Snake.curBattle&&(this.btn_jixu.visible=!1,this.btn_again.x=446)},n.prototype._closeHandler=function(t){this.dispatchEvent(new lxl.CEvent(lxl.CEvent.CLOSE,1))},n.prototype._close2Handler=function(t){this.dispatchEvent(new lxl.CEvent(lxl.CEvent.CLOSE,0))},n.prototype._helpHandler=function(e){this._help=new t.DlgHelp,this.pop(this._help),this._help.addEventListener(lxl.CEvent.CLOSE,this.helpClose,this)},n.prototype.helpClose=function(){this._help.removeEventListener(lxl.CEvent.CLOSE,this.helpClose,this),this._help.dispose(),this.btn_help.touchEnabled=this.btn_huyan.touchEnabled=this.btn_zhishi.touchEnabled=!0},n.prototype._huyanHandler=function(t){lxl.CDispatcher.getInstance().addListener(lxl.CEvent.PROTECTE_EYE,this._changeEyeState,this),lxl.CDispatcher.getInstance().dispatch(new lxl.CEvent(lxl.CEvent.EYE_CHANGE))},n.prototype._changeEyeState=function(t){lxl.CDispatcher.getInstance().removeListener(lxl.CEvent.PROTECTE_EYE,this._changeEyeState,this)},n.prototype._knowledgeHandler=function(e){this._zhishi=new t.DlgZhishi,this.pop(this._zhishi),this.btn_help.touchEnabled=this.btn_huyan.touchEnabled=this.btn_zhishi.touchEnabled=!1,this._zhishi.addEventListener(lxl.CEvent.CLOSE,this.knowledgeClose,this)},n.prototype.knowledgeClose=function(){this._zhishi.removeEventListener(lxl.CEvent.CLOSE,this.knowledgeClose,this),this._zhishi.dispose(),this.btn_help.touchEnabled=this.btn_huyan.touchEnabled=this.btn_zhishi.touchEnabled=!0},n.prototype.dispose=function(){e.prototype.dispose.call(this),this.btn_jixu.removeEventListener(lxl.CEvent.CLICK,this._closeHandler,this),this.btn_again.removeEventListener(lxl.CEvent.CLICK,this._close2Handler,this),this.btn_help.removeEventListener(lxl.CEvent.CLICK,this._helpHandler,this),this.btn_zhishi.removeEventListener(lxl.CEvent.CLICK,this._knowledgeHandler,this),this.btn_huyan.removeEventListener(lxl.CEvent.CLICK,this._huyanHandler,this)},n}(lxl.CComponent);t.DlgWin=e,__reflect(e.prototype,"app.DlgWin")}(app||(app={}));var app;!function(t){var e=function(t){function e(){return t.call(this,lxl.Config.SKIN_PATH+"DlgZhishiSkin.exml")||this}return __extends(e,t),e.prototype.onActivity=function(){t.prototype.onActivity.call(this);var e;e=new egret.Shape,e.graphics.beginFill(0,.4),e.graphics.drawRect(0,0,this.width,this.height),e.graphics.endFill(),this.addChildAt(e,0),this.btn_close.addEventListener(lxl.CEvent.CLICK,this._closeHandler,this),this.btn_huyan.addEventListener(lxl.CEvent.CLICK,this._huyanHandler,this)},e.prototype._closeHandler=function(t){this.dispatchEvent(new lxl.CEvent(lxl.CEvent.CLOSE))},e.prototype._huyanHandler=function(t){lxl.CDispatcher.getInstance().addListener(lxl.CEvent.PROTECTE_EYE,this._changeEyeState,this),lxl.CDispatcher.getInstance().dispatch(new lxl.CEvent(lxl.CEvent.EYE_CHANGE))},e.prototype._changeEyeState=function(t){lxl.CDispatcher.getInstance().removeListener(lxl.CEvent.PROTECTE_EYE,this._changeEyeState,this)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.btn_huyan.removeEventListener(lxl.CEvent.CLICK,this._huyanHandler,this),this.btn_close.removeEventListener(lxl.CEvent.CLICK,this._closeHandler,this)},e}(lxl.CComponent);t.DlgZhishi=e,__reflect(e.prototype,"app.DlgZhishi")}(app||(app={}));var lxl;!function(t){var e=function(){function t(){}return t}();e.MC_PATH="resource/assets/mc/",e.SKIN_PATH="resource/app_skins/",e.GRID_SIZE=48,t.Config=e,__reflect(e.prototype,"lxl.Config")}(lxl||(lxl={}));var lxl;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.str=new egret.ByteArray,e.arr=[],e}return __extends(e,t),e}(Object);t.BaseData=e,__reflect(e.prototype,"lxl.data.BaseData");var n=function(){function t(){}return t}();t.Map=n,__reflect(n.prototype,"lxl.data.Map")}(e=t.data||(t.data={}))}(lxl||(lxl={}));var lxl;!function(t){var e;!function(e){var n=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getCode=function(){return""},e.prototype.handlerPackage=function(t){},e.prototype.configure=function(t){},e.prototype.send=function(t){void 0===t&&(t=null)},e}(t.CDispatcher);e.BaseDataHandler=n,__reflect(n.prototype,"lxl.data.BaseDataHandler",["lxl.interfaces.IDataHandler","egret.IEventDispatcher"])}(e=t.data||(t.data={}))}(lxl||(lxl={}));var lxl;!function(t){var e;!function(e){var n=function(e){function n(t){var n=e.call(this)||this;return n._dataManager=t,n._netConnet=new egret.HttpRequest,n}return __extends(n,e),n.prototype.errorHandler=function(e){t.logs.log(e.type),this._dataManager.handlerSecurityError()},n.prototype.send=function(e,n,i){if(this._netConnet.open(e.getFullUrl(),egret.HttpMethod.POST),this._cb=n,this._ctx=i,this._netConnet.addEventListener(egret.IOErrorEvent.IO_ERROR,this.errorHandler,this),this._netConnet.addEventListener(egret.Event.COMPLETE,this._completeHandler,this),e.getParamLen()>0){this._netConnet.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var a=t.Tool.MapToField(e.getParam());this._netConnet.send(a)}else this._netConnet.send()},n.prototype._completeHandler=function(t){this._cb(this._netConnet.response,this._ctx),this.dispose()},n.prototype.dispose=function(){this._netConnet.hasEventListener(egret.IOErrorEvent.IO_ERROR)&&(this._netConnet.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.errorHandler,this),this._netConnet.removeEventListener(egret.Event.COMPLETE,this._cb,this._ctx))
},n}(egret.HashObject);e.NetData=n,__reflect(n.prototype,"lxl.data.NetData")}(e=t.data||(t.data={}))}(lxl||(lxl={}));var lxl;!function(t){var e;!function(t){var e=function(){function e(e,n){this._code=e,this._o=new t.BaseData,this._o=n}return e.prototype.code=function(){return this._code},e.prototype.readObj=function(){return this._o},e.prototype.readObjStr=function(){var t=JSON.stringify(this._o);if(this._o.propertyIsEnumerable(""))for(var e in this._o)t.concat(e,this._o[e]);return t},e}();t.PackageIn=e,__reflect(e.prototype,"lxl.data.PackageIn",["lxl.interfaces.IPackageIn"])}(e=t.data||(t.data={}))}(lxl||(lxl={}));var lxl;!function(t){var e;!function(t){var e=function(){function e(e){this._code=e,this._o=new t.BaseData}return e.prototype.writeString=function(t){null==t?this._o.str.writeUTF(""):this._o.str.writeUTFBytes(t)},e.prototype.writeArray=function(t){t.length>0&&(this._o.arr=t)},e.prototype.getParamLen=function(){return this._o.arr.length},e.prototype.getParamByIndex=function(t){return t>=0?this._o.arr[t]:0},e.prototype.getParam=function(){return this._o.arr},e.prototype.code=function(){return this._code},e.prototype.getFullUrl=function(){return""},e}();t.PackageOut=e,__reflect(e.prototype,"lxl.data.PackageOut",["lxl.interfaces.IPackageOut"])}(e=t.data||(t.data={}))}(lxl||(lxl={}));var app;!function(t){var e=function(){function t(){}return t}();e.SNAKE_DIRECTION="SnakeEvent::SnakeDirection",e.SPEED1=300,e.SPEED2=500,e.SPEED3=800,t.Config=e,__reflect(e.prototype,"app.Config");var n;!function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Up=2]="Up",t[t.Down=3]="Down"}(n||(n={}))}(app||(app={}));var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function i(i){e.call(n,i,t)}if(RES.hasRes(t)){var a=RES.getRes(t);a?i(a):RES.getResAsync(t,i,this)}else RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,i){function a(t){e.call(i,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),n.call(i))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(t,a,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var app;!function(t){var e=function(e){function n(){var t=e.call(this,"resource/app_skins/MainGrid.exml")||this;return t.stageH=0,t.stageW=0,t.arrSnakeParts=[],t.arrTargets=[],t._lock=!1,t.moveDistance="right",t.speed=0,t.score=0,t}return __extends(n,e),n.prototype.onActivity=function(){e.prototype.onActivity.call(this),this.btn_up.eps=.4,this.btn_right.eps=.4,this.btn_left.eps=.4,this.btn_down.eps=.4,this.btn_up.hasEventListener(lxl.CEvent.CLICK)||(this.btn_up.addEventListener(lxl.CEvent.CLICK,this._directionHandler,this),this.btn_down.addEventListener(lxl.CEvent.CLICK,this._directionHandler,this),this.btn_left.addEventListener(lxl.CEvent.CLICK,this._directionHandler,this),this.btn_right.addEventListener(lxl.CEvent.CLICK,this._directionHandler,this),this.btn_home.addEventListener(lxl.CEvent.CLICK,this._backHandler,this),this.btn_help.addEventListener(lxl.CEvent.CLICK,this._helpHandler,this),this.btn_knowledge.addEventListener(lxl.CEvent.CLICK,this._knowledgeHandler,this),this.btn_huyan.addEventListener(lxl.CEvent.CLICK,this._huyanHandler,this),lxl.CDispatcher.getInstance().addListener(t.SnakeManager.CHANGE_LIFE,this.changeLife,this),lxl.CDispatcher.getInstance().addListener(lxl.CEvent.LEFT,this._dirHandler,this),lxl.CDispatcher.getInstance().addListener(lxl.CEvent.UP,this._dirHandler,this),lxl.CDispatcher.getInstance().addListener(lxl.CEvent.RIGHT,this._dirHandler,this),lxl.CDispatcher.getInstance().addListener(lxl.CEvent.DOWN,this._dirHandler,this),this.btn_jian.addEventListener(lxl.CEvent.CLICK,this._jianshiHandler,this),lxl.CDispatcher.getInstance().addListener(lxl.CEvent.READONLY_CHANGE,this.readOnlyChange,this)),Snake.lastLife=3,this.stageH=this.stage.stageHeight,this.stageW=this.stage.stageWidth;var n=lxl.Tool.callJS("getInfoToken");"COORDINATOR"==n._userRole?(this.btn_jian.visible=!0,this.startGame()):(this.btn_jian.visible=!1,lxl.CDispatcher.getInstance().addListener(lxl.CEvent.GET_MESSAGE,this._updateData,this)),this.group.touchChildren=!Snake.readOnly,this.group.touchEnabled=!Snake.readOnly},n.prototype.startGame=function(){var t=this;Snake.createSnake(),Snake.genTargets();for(var e="",n=Snake.arrSnakeParts.length,i=0;n>i;i++)if(i==n-1)Snake.arrSnakeParts[i].imgSource="img_chongTou_png",Snake.arrSnakeParts[i].partRotation=this.moveDistance,""!=e&&(Snake.arrSnakeParts[i].value=e);else{Snake.arrSnakeParts[i].imgSource="img_chongShenTi_png";for(var a=0;n>a;a++)if(""!=Snake.arrSnakeParts[a].value){e=Snake.arrSnakeParts[a].value;break}}for(var i=0;i<Snake.arrSnakeParts.length;i++)Snake.arrSnakeParts[i].i=i,Snake.arrSnakeParts[i].addEventListener(lxl.CEvent.LOAD_SKIN_COMPLETE,function(e){t.addChildAt(Snake.arrSnakeParts[e.param.i],1)},this);for(var i=0;i<Snake.arrTargets.length;i++)Snake.arrTargets[i].i=i,Snake.arrTargets[i].addEventListener(lxl.CEvent.LOAD_SKIN_COMPLETE,function(e){t.addChildAt(Snake.arrTargets[e.param.i],1)},this);0!=n&&this.startTime(),this.lab_target.text=Snake.trueObj.cn.toString()},n.prototype.readOnlyChange=function(t){this.group.touchChildren=!Snake.readOnly,this.group.touchEnabled=!Snake.readOnly;var e=lxl.Tool.callJS("getInfoToken");if("STUDENT"==e._userRole&&0==Snake.readOnly){lxl.CDispatcher.getInstance().removeListener(lxl.CEvent.GET_MESSAGE,this._updateData,this);for(var n=0;n<this.arrSnakeParts.length;n++)this.removeChild(this.arrSnakeParts[n]);for(var n=0;n<this.arrTargets.length;n++)this.removeChild(this.arrTargets[n]);this.startGame()}},n.prototype._updateData=function(t){lxl.logs.log("e________"+t.param.gridSnake.length);var e=t.param;this.createSnakeOrMove(e.gridSnake),this.createTargets(e.gridMap,!0)},n.prototype.createSnakeOrMove=function(t){if(this.arrSnakeParts.length!=t.length){for(var e=0;e<this.arrSnakeParts.length;e++)this.removeChild(this.arrSnakeParts[e]);this.arrSnakeParts=[];for(var n=0;n<t.length;n++){var i=Snake.createPart();i.x=Snake.teacherAreaX+Math.floor(lxl.Config.GRID_SIZE*t[n].loc_x*Snake.scaleGrid),i.y=Snake.teacherAreaY+Math.floor(t[n].loc_y*lxl.Config.GRID_SIZE*Snake.scaleGrid),this.arrSnakeParts.push(i)}for(var a=0;a<this.arrSnakeParts.length;a++)this.addChild(this.arrSnakeParts[a])}else for(var n=0;n<t.length;n++)this.arrSnakeParts[n].x=Snake.teacherAreaX+Math.floor(lxl.Config.GRID_SIZE*t[n].loc_x*Snake.scaleGrid),this.arrSnakeParts[n].y=Snake.teacherAreaY+Math.floor(t[n].loc_y*lxl.Config.GRID_SIZE*Snake.scaleGrid)},n.prototype.createTargets=function(t,e){if(1==e){for(var n=0;n<this.arrTargets.length;n++)this.removeChild(this.arrTargets[n]);this.arrTargets=[];for(var n=0;n<t.length;n++){var i=Snake.createTarget();i.x=t[n].loc_x*Snake.scaleGrid*lxl.Config.GRID_SIZE,i.y=t[n].loc_y*Snake.scaleGrid*lxl.Config.GRID_SIZE,i.setTarget(t[n].value,Snake.areaW,Snake.areaH),i.vd=t[n],this.arrTargets.push(i)}for(var n=0;n<this.arrTargets.length;n++)this.addChild(this.arrTargets[n])}else for(var n=0;n<this.arrTargets.length;n++)for(var a=0;a<t.length;a++)if(this.arrTargets[n].value==t[a].value&&this.arrTargets[n].vd.loc_x==t[a].loc_x&&this.arrTargets[n].vd.loc_y==t[a].loc_y)return void this.removeChild(this.arrTargets[n])},n.prototype.reset=function(){this._timer.stop();for(var t=0;t<Snake.arrSnakeParts.length;t++)this.removeChild(Snake.arrSnakeParts[t]);for(var t=Snake.arrTargets.length-1;t>=0;t--)this.removeChild(Snake.arrTargets[t]);this.moveDistance="right",this.lab_value.text="",this.lab_target.text="",this.onActivity()},n.prototype.startTime=function(){this._timer=new egret.Timer(Snake.timeNum),this._timer.hasEventListener(egret.TimerEvent.TIMER)||this._timer.addEventListener(egret.TimerEvent.TIMER,this.viewUpdate,this),this._timer.start()},n.prototype.dispose=function(){e.prototype.dispose.call(this),this.btn_up.removeEventListener(lxl.CEvent.CLICK,this._directionHandler,this),this.btn_down.removeEventListener(lxl.CEvent.CLICK,this._directionHandler,this),this.btn_left.removeEventListener(lxl.CEvent.CLICK,this._directionHandler,this),this.btn_right.removeEventListener(lxl.CEvent.CLICK,this._directionHandler,this),this.btn_help.removeEventListener(lxl.CEvent.CLICK,this._helpHandler,this),this.btn_knowledge.removeEventListener(lxl.CEvent.CLICK,this._knowledgeHandler,this),this._timer.stop(),this._timer.hasEventListener(egret.TimerEvent.TIMER)&&this._timer.removeEventListener(egret.TimerEvent.TIMER,this.viewUpdate,this),lxl.CDispatcher.getInstance().removeListener(t.SnakeManager.CHANGE_LIFE,this.changeLife,this),lxl.CDispatcher.getInstance().removeListener(lxl.CEvent.LEFT,this._dirHandler,this),lxl.CDispatcher.getInstance().removeListener(lxl.CEvent.UP,this._dirHandler,this),lxl.CDispatcher.getInstance().removeListener(lxl.CEvent.RIGHT,this._dirHandler,this),lxl.CDispatcher.getInstance().removeListener(lxl.CEvent.DOWN,this._dirHandler,this),this.btn_jian.removeEventListener(lxl.CEvent.CLICK,this._jianshiHandler,this)},n.prototype._jianshiHandler=function(t){this.dispatchEvent(new lxl.CEvent(lxl.CEvent.OPEN))},n.prototype.changeLife=function(t){var e=this;if(void 0!=this.img_1&&3-(3-Snake.lastLife)!=3&&Snake.lastLife>=0)egret.Tween.get(this["img_"+(3-(3-Snake.lastLife)+1)]).to({scaleX:.8,scaleY:.8},200).to({scaleX:1.1,scaleY:1.1},200).to({scaleX:.7,scaleY:.7},200).to({scaleX:5,scaleY:5,alpha:0},100).call(function(){for(var t=0;3>t;t++)e["img_"+(t+1)].visible=!1,e["img_"+(t+1)].alpha=1,e["img_"+(t+1)].scaleX=1,e["img_"+(t+1)].scaleY=1;for(var t=0;t<Snake.lastLife;t++)e["img_"+(t+1)].visible=!0});else{for(var n=0;3>n;n++)this["img_"+(n+1)].visible=!1;for(var n=0;n<Snake.lastLife;n++)this["img_"+(n+1)].visible=!0}},n.prototype.gameOver=function(){var t=this;return 0==Snake.lastLife?(this._timer.removeEventListener(egret.TimerEvent.TIMER,this.viewUpdate,this),void this._showFail()):(this._timer.stop(),this._sound=Res.getRes("wall_mp3"),this._sound.play(0,1),this._lock=!0,Snake.lastLife--,this.moveDistance="right",egret.Tween.get(this).wait(1e3).call(function(){Snake.resetSnake(),t.moveDistance="right",t._timer.start(),t._lock=!1}),0==Snake.lastLife?(this._timer.removeEventListener(egret.TimerEvent.TIMER,this.viewUpdate,this),void this._showFail()):void 0)},n.prototype._showWin=function(){this._lock=!0,this._timer.removeEventListener(egret.TimerEvent.TIMER,this.viewUpdate,this),this._win=new t.DlgWin,this.pop(this._win),this._win.addEventListener(lxl.CEvent.CLOSE,this._winClose,this)},n.prototype._showFail=function(){this._lock=!0,this._timer.removeEventListener(egret.TimerEvent.TIMER,this.viewUpdate,this),this._fail=new t.DlgFail,this.pop(this._fail),this._fail.addEventListener(lxl.CEvent.CLOSE,this._failClose,this)},n.prototype._winClose=function(t){void 0===t&&(t=null),this._lock=!1,this._win.removeEventListener(lxl.CEvent.CLOSE,this._winClose,this),this._win.dispose(),1==t.param&&(Snake.curBattle++,Snake.curBattle>=5&&(Snake.curBattle=4)),this.reset()},n.prototype._failClose=function(){this._lock=!1,this._fail.removeEventListener(lxl.CEvent.CLOSE,this._failClose,this),this._fail.dispose(),this.reset()},n.prototype._dirHandler=function(t){"up"==t.param&&"down"!=this.moveDistance?(this.moveDistance="up",this.viewUpdate()):"down"==t.param&&"up"!=this.moveDistance?(this.moveDistance="down",this.viewUpdate()):"left"==t.param&&"right"!=this.moveDistance?(this.moveDistance="left",this.viewUpdate()):"right"==t.param&&"left"!=this.moveDistance&&(this.moveDistance="right",this.viewUpdate())},n.prototype._directionHandler=function(t){t.target==this.btn_up&&"down"!=this.moveDistance?(this.moveDistance="up",this.viewUpdate()):t.target==this.btn_down&&"up"!=this.moveDistance?(this.moveDistance="down",this.viewUpdate()):t.target==this.btn_left&&"right"!=this.moveDistance?(this.moveDistance="left",this.viewUpdate()):t.target==this.btn_right&&"left"!=this.moveDistance&&(this.moveDistance="right",this.viewUpdate())},n.prototype.animateTarget=function(t){var e=this;egret.Tween.get(t).to({scaleX:1.3,scaleY:1.3},200).to({x:this.lab_value.x,y:this.lab_value.y,scaleX:.7,scaleY:.7},200).to({scaleX:.3,scaleY:.3,alpha:0},200).call(function(){e.lab_value.text+=t.value,e.removeChild(t)})},n.prototype.viewUpdate=function(t){void 0===t&&(t=null);var e=Snake.arrSnakeParts[Snake.arrSnakeParts.length-1];if(1!=this._lock){if(9!=this.speed&&(this.speed=Math.floor(this.score/10)),0==Snake.arrSnakeParts.length)return void this._showWin();for(var n=Snake.arrSnakeParts[Snake.arrSnakeParts.length-1],i=0;i<Snake.arrTargets.length;i++){var a=Snake.arrTargets[i];if(n.x==a.x&&n.y==a.y&&""!=n.value){if(a.value!=Snake.trueTargets[0])return void this.gameOver();this.score++,this.removeChild(Snake.arrSnakeParts[0]),Snake.arrSnakeParts.shift(),this.animateTarget(Snake.arrTargets[i]),Snake.arrTargets.splice(i,1),Snake.trueTargets.splice(0,1),Snake.viewData.gridSnake.shift(),Snake.viewData.gridMap.splice(i,1)}}for(var r=0;r<Snake.arrSnakeParts.length-1;r++)if(e.x==Snake.arrSnakeParts[r].x&&e.y==Snake.arrSnakeParts[r].y)return void this.gameOver();0!=Snake.arrSnakeParts.length&&this.move(),Snake.dataHandler.sendMessageToServer(Snake.viewData)}},n.prototype.move=function(){var t=Snake.arrSnakeParts[Snake.arrSnakeParts.length-1],e=t.x,n=t.y,i=Snake.arrSnakeParts[0],a=(i.x,i.y,Snake.viewData.gridSnake[Snake.viewData.gridSnake.length-1]),r=Snake.viewData.gridSnake[0],s=a.loc_x,o=a.loc_y;r.loc_x,r.loc_y;if("up"==this.moveDistance){if(n<=Snake.areaY)return void this.gameOver();i.y=n-lxl.Config.GRID_SIZE,r.loc_y=o-1,i.x=e,r.loc_x=s,Snake.arrSnakeParts.shift(),Snake.arrSnakeParts.push(i),Snake.viewData.gridSnake.shift(),Snake.viewData.gridSnake.push(r)}else if("down"==this.moveDistance){if(n+lxl.Config.GRID_SIZE>=Snake.areaH+Snake.areaY)return void this.gameOver();i.y=n+lxl.Config.GRID_SIZE,r.loc_y=o+1,i.x=e,r.loc_x=s,Snake.arrSnakeParts.shift(),Snake.arrSnakeParts.push(i),Snake.viewData.gridSnake.shift(),Snake.viewData.gridSnake.push(r)}else if("left"==this.moveDistance){if(e<=Snake.areaX)return void this.gameOver();i.x=e-lxl.Config.GRID_SIZE,r.loc_x=s-1,i.y=n,r.loc_y=o,Snake.arrSnakeParts.shift(),Snake.arrSnakeParts.push(i),Snake.viewData.gridSnake.shift(),Snake.viewData.gridSnake.push(r)}else if("right"==this.moveDistance){if(e+lxl.Config.GRID_SIZE>=Snake.areaW+Snake.areaX)return void this.gameOver();i.x=e+lxl.Config.GRID_SIZE,r.loc_x=s+1,i.y=n,r.loc_y=o,Snake.arrSnakeParts.shift(),Snake.arrSnakeParts.push(i),Snake.viewData.gridSnake.shift(),Snake.viewData.gridSnake.push(r)}for(var l=Snake.arrSnakeParts.length,h="",c=0;l>c;c++)if(c==l-1)Snake.arrSnakeParts[c].imgSource="img_chongTou_png",Snake.arrSnakeParts[c].partRotation=this.moveDistance,Snake.viewData.gridSnake[c].dir=this.moveDistance,Snake.viewData.gridSnake[c].isHead=!0,""!=h&&(Snake.arrSnakeParts[c].value=h);else{Snake.arrSnakeParts[c].imgSource="img_chongShenTi_png";for(var p=0;l>p;p++)if(""!=Snake.arrSnakeParts[p].value){h=Snake.arrSnakeParts[p].value;break}Snake.viewData.gridSnake[c].isHead=!1,Snake.arrSnakeParts[c].value=""}},n.prototype._helpHandler=function(e){this._timer.stop(),this._help=new t.DlgHelp,this.pop(this._help),this.btn_help.touchEnabled=this.btn_huyan.touchEnabled=this.btn_knowledge.touchEnabled=!1,this._help.addEventListener(lxl.CEvent.CLOSE,this.helpClose,this)},n.prototype.helpClose=function(){this._help.removeEventListener(lxl.CEvent.CLOSE,this.helpClose,this),this._help.dispose(),this.btn_help.touchEnabled=this.btn_huyan.touchEnabled=this.btn_knowledge.touchEnabled=!0,this._timer.start()},n.prototype._huyanHandler=function(t){lxl.CDispatcher.getInstance().addListener(lxl.CEvent.PROTECTE_EYE,this._changeEyeState,this),lxl.CDispatcher.getInstance().dispatch(new lxl.CEvent(lxl.CEvent.EYE_CHANGE))},n.prototype._changeEyeState=function(t){lxl.CDispatcher.getInstance().removeListener(lxl.CEvent.PROTECTE_EYE,this._changeEyeState,this)},n.prototype._knowledgeHandler=function(e){this._timer.stop(),this._zhishi=new t.DlgZhishi,this.pop(this._zhishi),this.btn_help.touchEnabled=this.btn_huyan.touchEnabled=this.btn_knowledge.touchEnabled=!1,this._zhishi.addEventListener(lxl.CEvent.CLOSE,this.knowledgeClose,this)},n.prototype.knowledgeClose=function(){this._zhishi.removeEventListener(lxl.CEvent.CLOSE,this.knowledgeClose,this),this._zhishi.dispose(),this.btn_help.touchEnabled=this.btn_huyan.touchEnabled=this.btn_knowledge.touchEnabled=!0,this._timer.start()},n.prototype._backHandler=function(t){this.dispatchEvent(new lxl.CEvent(lxl.CEvent.BACK))},n}(lxl.CComponent);t.MainGrid=e,__reflect(e.prototype,"app.MainGrid")}(app||(app={}));var app;!function(t){var e=function(e){function n(){return e.call(this,lxl.Config.SKIN_PATH+"MainSence.exml")||this}return __extends(n,e),n.prototype.onActivity=function(){e.prototype.onActivity.call(this),this.btn_start.addEventListener(lxl.CEvent.CLICK,this._startHandler,this),this.btn_help.addEventListener(lxl.CEvent.CLICK,this._helpHandler,this),this.btn_knowledge.addEventListener(lxl.CEvent.CLICK,this._knowledgeHandler,this),this.btn_huyan.addEventListener(lxl.CEvent.CLICK,this._huyanHandler,this),this.btn_yanshi.addEventListener(lxl.CEvent.CLICK,this._yanshiHandler,this);var t=lxl.Tool.callJS("getInfoToken");"COORDINATOR"==t._userRole&&(Snake.viewData.type="show",Snake.dataHandler.sendMessageToServer(Snake.viewData))},n.prototype._yanshiHandler=function(t){lxl.CDispatcher.getInstance().dispatch(new lxl.CEvent(lxl.CEvent.OPEN))},n.prototype._huyanHandler=function(t){lxl.CDispatcher.getInstance().addListener(lxl.CEvent.PROTECTE_EYE,this._changeEyeState,this),lxl.CDispatcher.getInstance().dispatch(new lxl.CEvent(lxl.CEvent.EYE_CHANGE))},n.prototype._changeEyeState=function(t){lxl.CDispatcher.getInstance().removeListener(lxl.CEvent.PROTECTE_EYE,this._changeEyeState,this)},n.prototype._startHandler=function(t){lxl.CDispatcher.getInstance().dispatch(new lxl.CEvent(lxl.CEvent.CLICK))},n.prototype._helpHandler=function(e){this._help=new t.DlgHelp,this.pop(this._help),this.btn_help.touchEnabled=this.btn_knowledge.touchEnabled=!1,this._help.addEventListener(lxl.CEvent.CLOSE,this.helpClose,this)},n.prototype.helpClose=function(){this._help.removeEventListener(lxl.CEvent.CLOSE,this.helpClose,this),this._help.dispose(),this.btn_help.touchEnabled=this.btn_knowledge.touchEnabled=!0},n.prototype._knowledgeHandler=function(e){this._zhishi=new t.DlgZhishi,this.pop(this._zhishi),this.btn_help.touchEnabled=this.btn_knowledge.touchEnabled=!1,this._zhishi.addEventListener(lxl.CEvent.CLOSE,this.zhishiClose,this)},n.prototype.zhishiClose=function(){this._zhishi.removeEventListener(lxl.CEvent.CLOSE,this.zhishiClose,this),this._zhishi.dispose(),this.btn_help.touchEnabled=this.btn_knowledge.touchEnabled=!0},n}(lxl.CComponent);t.MainSence=e,__reflect(e.prototype,"app.MainSence")}(app||(app={}));var Res=lxl.GlobalData.getInstance().resManager,Snake=app.SnakeManager.getInstance(),Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.start=function(){t.prototype.start.call(this),this.root=new app.SnakeSence,lxl.GlobalData.getInstance().root=this,this.stage.scaleMode=egret.StageScaleMode.SHOW_ALL,this.stage.orientation=egret.OrientationMode.LANDSCAPE},e}(lxl.Application);__reflect(Main.prototype,"Main");var lxl;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.createView=function(){this.textField=new egret.TextField,this.textField.textColor=16737945,this.textField.size=20,this.textField.width=280,this.textField.height=100,this.textField.textAlign="center",this.textField.x=this.width/2-this.textField.width/2;var e=t.Tool.createBitmapByName("logo_png"),n=1.775*this.height,i=this.height*(e.height/1080),a=n*(e.width/1920);e.width=a,e.height=i,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=this.width/2,e.y=this.height/2,this.textField.y=this.height-100,this.addChild(e),this.addChild(this.textField)},n.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},n}(egret.Sprite);t.LoadingUI=e,__reflect(e.prototype,"lxl.LoadingUI")}(lxl||(lxl={}));var lxl;!function(t){var e=function(){function t(){}return t.prototype.log=function(t){console.log(t)},t.prototype.fatal=function(t){alert(t)},t}();t.Log=e,__reflect(e.prototype,"lxl.Log"),t.logs=new e}(lxl||(lxl={}));var lxl;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._w=0,e._h=0,e}return __extends(e,t),e.prototype.setSize=function(t,e){this._w=t,this._h=e},e.prototype.animation=function(){var t=this;egret.Tween.get(this).to({alpha:1},800,egret.Ease.quintOut).wait(1600).to({alpha:0},1e3,egret.Ease.quintIn).call(function(){t.parent&&t.parent.removeChild(t)})},e.prototype.init=function(t,e){this._cont=t,this._txtrToastBg=e},e}(egret.DisplayObjectContainer);t.Pops=e,__reflect(e.prototype,"lxl.Pops");var n=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(e,n){t.prototype.init.call(this,e,n),this._bg=new egret.Bitmap(this._txtrToastBg),this._bg.height=35,this._bg.anchorOffsetX=this._bg.width/2,this._bg.anchorOffsetY=this._bg.height/2,this._tx=new egret.TextField,this._tx.size=20,this._tx.bold=!0,this._tx.textColor=16777215,this._tx.stroke=2,this._tx.strokeColor=0,this._tx.fontFamily="微软雅黑",this._tx.textAlign=egret.HorizontalAlign.CENTER,this.addChild(this._bg),this.addChild(this._tx)},e.prototype.inits=function(t){void 0===t&&(t=""),this._tx.text=t,this._tx.height=30,this._tx.width=this._w,this._tx.anchorOffsetX=this._w/2,this._tx.anchorOffsetY=this._tx.height/2,this._bg.x=this.stage.stageWidth/2,this._bg.y=this.stage.stageHeight/2,this._tx.x=this._bg.x,this._tx.y=this._bg.y,this.alpha=1},e.prototype.launch=function(t,e){void 0===e&&(e=!0),this._cont&&(this.setSize(this._cont.stage.stageWidth,this._cont.stage.stageHeight),this._cont.addChild(this),this.inits(t),e&&this.animation())},e.getInstance=function(){return null==this._t&&(this._t=new e),this._t},e}(e);t.Toast=n,__reflect(n.prototype,"lxl.Toast")}(lxl||(lxl={}));var app;!function(t){var e=function(e){function n(){return e.call(this,lxl.Config.SKIN_PATH+"DlgFailSkin.exml")||this}return __extends(n,e),n.prototype.onActivity=function(){e.prototype.onActivity.call(this);var t;t=new egret.Shape,t.graphics.beginFill(0,.4),t.graphics.drawRect(0,0,this.width,this.height),t.graphics.endFill(),this.addChildAt(t,0),this.btn_jixu.addEventListener(lxl.CEvent.CLICK,this._closeHandler,this),this.btn_help.addEventListener(lxl.CEvent.CLICK,this._helpHandler,this),this.btn_zhishi.addEventListener(lxl.CEvent.CLICK,this._knowledgeHandler,this),this.btn_huyan.addEventListener(lxl.CEvent.CLICK,this._huyanHandler,this),this._sound=Res.getRes("lose_mp3"),this._sound.play(0,1)},n.prototype._closeHandler=function(t){this.dispatchEvent(new lxl.CEvent(lxl.CEvent.CLOSE))},n.prototype._helpHandler=function(e){this._help=new t.DlgHelp,this.pop(this._help),this._help.addEventListener(lxl.CEvent.CLOSE,this.helpClose,this)},n.prototype.helpClose=function(){this._help.removeEventListener(lxl.CEvent.CLOSE,this.helpClose,this),this._help.dispose(),this.btn_help.touchEnabled=this.btn_huyan.touchEnabled=this.btn_zhishi.touchEnabled=!0},n.prototype._huyanHandler=function(t){lxl.CDispatcher.getInstance().addListener(lxl.CEvent.PROTECTE_EYE,this._changeEyeState,this),lxl.CDispatcher.getInstance().dispatch(new lxl.CEvent(lxl.CEvent.EYE_CHANGE))},n.prototype._changeEyeState=function(t){lxl.CDispatcher.getInstance().removeListener(lxl.CEvent.PROTECTE_EYE,this._changeEyeState,this)},n.prototype._knowledgeHandler=function(e){this._zhishi=new t.DlgZhishi,this.pop(this._zhishi),this.btn_help.touchEnabled=this.btn_huyan.touchEnabled=this.btn_zhishi.touchEnabled=!1,this._zhishi.addEventListener(lxl.CEvent.CLOSE,this.knowledgeClose,this)},n.prototype.knowledgeClose=function(){this._zhishi.removeEventListener(lxl.CEvent.CLOSE,this.knowledgeClose,this),this._zhishi.dispose(),this.btn_help.touchEnabled=this.btn_huyan.touchEnabled=this.btn_zhishi.touchEnabled=!0},n.prototype.dispose=function(){e.prototype.dispose.call(this),this.btn_jixu.removeEventListener(lxl.CEvent.CLICK,this._closeHandler,this),this.btn_help.removeEventListener(lxl.CEvent.CLICK,this._helpHandler,this),this.btn_zhishi.removeEventListener(lxl.CEvent.CLICK,this._knowledgeHandler,this),this.btn_huyan.removeEventListener(lxl.CEvent.CLICK,this._huyanHandler,this)},n}(lxl.CComponent);t.DlgFail=e,__reflect(e.prototype,"app.DlgFail")}(app||(app={}));var lxl;!function(t){var e=function(){function t(){}return t.isPC_Mode=function(){return"Windows PC"==egret.Capabilities.os?!0:"Mac OS"==egret.Capabilities.os?!0:!1},t.callJS=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return"native"==egret.Capabilities.runtimeType?"":window[t].apply(window,e)},t.MapToField=function(t){var e=[];return t.forEach(function(t){e.push(t.k+"="+encodeURIComponent(t.v))},this),e.join("&")},t.getValueByKey=function(t,e){for(var n,i=0;i<t.length;i++)if(t[i].k==e)return n=t[i].v;return null},t.setMapValue=function(t,e){for(var n=0;n<t.length;n++)if(t[n].k==e.k)return void(t[n].v=e.v);t.push(e)},t.getMapValue=function(t,e){for(var n=0;n<t.length;n++)if(t[n].k==e)return t[n];return null},t.removeMapValue=function(t,e){for(var n=0;n<t.length;n++)t[n].k==e&&t.splice(n,1)},t.createBitmapByName=function(t){var e=new egret.Bitmap,n=Res.getRes(t);return e.texture=n,e},t.copyObject=function(t){var e={};for(var n in t)e[n]=t[n];return e},t}();t.Tool=e,__reflect(e.prototype,"lxl.Tool")}(lxl||(lxl={}));var app;!function(t){var e=function(e){function n(){var t=e.call(this,lxl.Config.SKIN_PATH+"SelBattle.exml")||this;return t._battle=-1,t._speed=-1,t}return __extends(n,e),n.prototype.onActivity=function(){e.prototype.onActivity.call(this),this.btn_1.addEventListener(lxl.CEvent.CLICK,this._btnHandler,this),this.btn_2.addEventListener(lxl.CEvent.CLICK,this._btnHandler,this),this.btn_3.addEventListener(lxl.CEvent.CLICK,this._btnHandler,this),this.btn_4.addEventListener(lxl.CEvent.CLICK,this._btnHandler,this),this.btn_5.addEventListener(lxl.CEvent.CLICK,this._btnHandler,this),this.btn_s1.addEventListener(lxl.CEvent.CLICK,this._sHandler,this),this.btn_s2.addEventListener(lxl.CEvent.CLICK,this._sHandler,this),this.btn_s3.addEventListener(lxl.CEvent.CLICK,this._sHandler,this),this.btn_home.addEventListener(lxl.CEvent.CLICK,this._homeHandler,this),this.btn_help.addEventListener(lxl.CEvent.CLICK,this._helpHandler,this),this.btn_zhishi.addEventListener(lxl.CEvent.CLICK,this._knowledgeHandler,this),this.btn_huyan.addEventListener(lxl.CEvent.CLICK,this._huyanHandler,this);var t;t=new egret.Shape,t.graphics.beginFill(0,.6),t.graphics.drawRect(0,0,this.width,this.height),t.graphics.endFill(),this.addChildAt(t,0)},n.prototype.showAct1=function(t){for(var e=0;5>e;e++)this["img_"+(e+1)].visible=!1;this["img_"+t].visible=!0},n.prototype.showAct2=function(t){for(var e=0;3>e;e++)this["img_s"+(e+1)].visible=!1;this["img_s"+t].visible=!0},n.prototype._huyanHandler=function(t){lxl.CDispatcher.getInstance().addListener(lxl.CEvent.PROTECTE_EYE,this._changeEyeState,this),lxl.CDispatcher.getInstance().dispatch(new lxl.CEvent(lxl.CEvent.EYE_CHANGE))},n.prototype._changeEyeState=function(t){lxl.CDispatcher.getInstance().removeListener(lxl.CEvent.PROTECTE_EYE,this._changeEyeState,this)},n.prototype._helpHandler=function(e){this._help=new t.DlgHelp,this.pop(this._help),this.btn_help.touchEnabled=this.btn_zhishi.touchEnabled=!1,this._help.addEventListener(lxl.CEvent.CLOSE,this.helpClose,this)},n.prototype.helpClose=function(){this._help.removeEventListener(lxl.CEvent.CLOSE,this.helpClose,this),this._help.dispose(),this.btn_help.touchEnabled=this.btn_zhishi.touchEnabled=!0},n.prototype._knowledgeHandler=function(e){this._zhishi=new t.DlgZhishi,this.pop(this._zhishi),this.btn_help.touchEnabled=this.btn_zhishi.touchEnabled=!1,this._zhishi.addEventListener(lxl.CEvent.CLOSE,this.zhishiClose,this)},n.prototype.zhishiClose=function(){this._zhishi.removeEventListener(lxl.CEvent.CLOSE,this.zhishiClose,this),this._zhishi.dispose(),this.btn_help.touchEnabled=this.btn_zhishi.touchEnabled=!0},n.prototype._homeHandler=function(t){this.dispatchEvent(new lxl.CEvent(lxl.CEvent.BACK))},n.prototype._btnHandler=function(t){t.param.target==this.btn_1?Snake.curBattle=0:t.param.target==this.btn_2?Snake.curBattle=1:t.param.target==this.btn_3?Snake.curBattle=2:t.param.target==this.btn_4?Snake.curBattle=3:t.param.target==this.btn_5&&(Snake.curBattle=4),this._battle=Snake.curBattle,this.showAct1(Snake.curBattle+1),-1!=this._speed&&this.dispatchEvent(new lxl.CEvent(lxl.CEvent.SEL_COMPLETE))},n.prototype._sHandler=function(e){e.param.target==this.btn_s1?(Snake.timeNum=t.Config.SPEED3,this.showAct2(1)):e.param.target==this.btn_s2?(Snake.timeNum=t.Config.SPEED2,this.showAct2(2)):e.param.target==this.btn_s3&&(Snake.timeNum=t.Config.SPEED1,this.showAct2(3)),this._speed=Snake.timeNum,-1!=this._battle&&this.dispatchEvent(new lxl.CEvent(lxl.CEvent.SEL_COMPLETE))},n}(lxl.CComponent);t.SelBattle=e,__reflect(e.prototype,"app.SelBattle")}(app||(app={}));var lxl;!function(t){var e;!function(e){var n=function(e){function n(){var t=e.call(this)||this;return t.eps=.2,t._clickEps=.2,t._selected=!1,t.addEventListener(egret.TouchEvent.TOUCH_TAP,t._onClick,t),t.addEventListener(eui.UIEvent.ADDED_TO_STAGE,t.onActivity,t),t}return __extends(n,e),Object.defineProperty(n.prototype,"selected",{get:function(){return this._selected},set:function(t){this._selected=t,0==t?this.currentState="up":this.currentState="sel"},enumerable:!0,configurable:!0}),n.prototype.onActivity=function(t){this.init()},n.prototype.init=function(){this.eps>0&&(this._timer=new egret.Timer(1e3*this.eps),this._timer.addEventListener(egret.TimerEvent.TIMER,this._timerHandler,this),this._timer.start())},n.prototype._timerHandler=function(t){this._clickEps=this._clickEps==this.eps?this.eps:this._clickEps+.1},n.prototype._onClick=function(e){this.scaleX=this.scaleY=.9;var n=t.Tool.copyObject(e);egret.Tween.get(this).to({scaleX:.9,scaleY:.9},200).to({scaleX:1,scaleY:1},100).call(function(){this._clickEps=0,this.dispatchEvent(new t.CEvent(t.CEvent.CLICK,n))},this)},n}(eui.Button);e.CButton=n,__reflect(n.prototype,"lxl.ui.CButton")}(e=t.ui||(t.ui={}))}(lxl||(lxl={}));var app;!function(t){var e=function(t){function e(){return t.call(this,lxl.Config.SKIN_PATH+"DlgHelpSkin.exml")||this}return __extends(e,t),e.prototype.onActivity=function(){t.prototype.onActivity.call(this);var e;e=new egret.Shape,e.graphics.beginFill(0,.4),e.graphics.drawRect(0,0,this.width,this.height),e.graphics.endFill(),this.addChildAt(e,0),this.btn_close.addEventListener(lxl.CEvent.CLICK,this._closeHandler,this),this.btn_huyan.addEventListener(lxl.CEvent.CLICK,this._huyanHandler,this)},e.prototype._closeHandler=function(t){this.dispatchEvent(new lxl.CEvent(lxl.CEvent.CLOSE))},e.prototype._huyanHandler=function(t){lxl.CDispatcher.getInstance().addListener(lxl.CEvent.PROTECTE_EYE,this._changeEyeState,this),lxl.CDispatcher.getInstance().dispatch(new lxl.CEvent(lxl.CEvent.EYE_CHANGE))},e.prototype._changeEyeState=function(t){lxl.CDispatcher.getInstance().removeListener(lxl.CEvent.PROTECTE_EYE,this._changeEyeState,this)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.btn_close.removeEventListener(lxl.CEvent.CLICK,this._closeHandler,this),this.btn_huyan.removeEventListener(lxl.CEvent.CLICK,this._huyanHandler,this)},e}(lxl.CComponent);t.DlgHelp=e,__reflect(e.prototype,"app.DlgHelp")}(app||(app={}));var app;!function(t){var e=function(t){function e(){var e=t.call(this,lxl.Config.SKIN_PATH+"SnakePart.exml")||this;return e._value="",e._rotation="",e.i=0,e._rotate=0,e.width=lxl.Config.GRID_SIZE,e.height=lxl.Config.GRID_SIZE,e.lab_text=new eui.Label,e.lab_text.size=22,e.lab_text.width=52,e.lab_text.textAlign="center",e}return __extends(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value
},set:function(t){this._value=t,void 0!=this.lab_value&&""==this._value&&(this.lab_value.text="",this.lab_text.text="")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"partRotation",{get:function(){return this._rotation},set:function(t){var e=0;switch(t){case"up":e=0;break;case"right":e=90;break;case"down":e=180;break;case"left":e=270}this._rotation=t,this._rotate=e,void 0!=this.img_part&&(this.img_part.rotation=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imgSource",{set:function(t){this._imgSource=t,void 0!=this.img_part&&(this.img_part.source=t)},enumerable:!0,configurable:!0}),e.prototype.onActivity=function(){t.prototype.onActivity.call(this),this.lab_text.x=-2,this.lab_text.y=13,this.addChild(this.lab_text),this.img_part.rotation=this._rotate,this.img_part.source=this._imgSource,""==this._value&&(this.lab_value.text="",this.lab_text.text="")},e}(lxl.CComponent);t.SnakePart=e,__reflect(e.prototype,"app.SnakePart")}(app||(app={}));var app;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.onActivity=function(){var n=this;e.prototype.onActivity.call(this),lxl.CDispatcher.getInstance().addListener(lxl.CEvent.CLICK,this.closeMain2,this);var i=new t.MainSence;i.width=this.stage.stageWidth,i.height=this.stage.stageHeight,i.name="main",i.once(lxl.CEvent.LOAD_SKIN_COMPLETE,function(){n.addChild(i)},this)},n.prototype.closeMain2=function(e){var n=this,i=new t.MainGrid;i.width=this.stage.stageWidth,i.height=this.stage.stageHeight,i.name="man",i.once(lxl.CEvent.LOAD_SKIN_COMPLETE,function(){n.addChild(i)},this),i.addEventListener(lxl.CEvent.BACK,this._backMainHandler,this),i.addEventListener(lxl.CEvent.OPEN,this._openJianHandler,this)},n.prototype._openJianHandler=function(e){var n=this,i=new t.TeachWatchView;i.width=this.stage.stageWidth,i.height=this.stage.stageHeight,i.name="teacherView",i.once(lxl.CEvent.LOAD_SKIN_COMPLETE,function(){n.addChild(i),Snake.viewData.type="normal",Snake.dataHandler.sendMessageToServer(Snake.viewData)},this)},n.prototype.closeMain=function(e){var n=this,i=new t.SelBattle;i.width=this.stage.stageWidth,i.height=this.stage.stageHeight,i.name="sel",i.once(lxl.CEvent.LOAD_SKIN_COMPLETE,function(){n.addChild(i)},this),i.addEventListener(lxl.CEvent.SEL_COMPLETE,this.closeSel,this),i.addEventListener(lxl.CEvent.BACK,this._backHandler,this)},n.prototype._backHandler=function(t){this.getChildByName("sel").removeEventListener(lxl.CEvent.SEL_COMPLETE,this.closeSel,this),this.getChildByName("sel").removeEventListener(lxl.CEvent.BACK,this._backHandler,this),this.getChildByName("sel").dispose()},n.prototype.closeSel=function(e){var n=this,i=new t.MainGrid;i.width=this.stage.stageWidth,i.height=this.stage.stageHeight,i.name="man",i.once(lxl.CEvent.LOAD_SKIN_COMPLETE,function(){n.getChildByName("sel").removeEventListener(lxl.CEvent.SEL_COMPLETE,n.closeSel,n),n.getChildByName("sel").removeEventListener(lxl.CEvent.BACK,n._backHandler,n),n.getChildByName("sel").dispose(),n.addChild(i)},this),i.addEventListener(lxl.CEvent.BACK,this._backMainHandler,this)},n.prototype._backMainHandler=function(t){this.getChildByName("man").removeEventListener(lxl.CEvent.BACK,this._backMainHandler,this),this.getChildByName("man").dispose()},n}(lxl.ui.CLayer);t.SnakeSence=e,__reflect(e.prototype,"app.SnakeSence")}(app||(app={}));var lxl;!function(t){var e=function(){function t(){}return t.drawArrowWithVector=function(t,e,n){var i=10,a=30,r=e.x,s=e.y,o=n.x,l=n.y,h=Math.atan2(s-l,r-o)*(180/Math.PI);t.lineStyle(5,16733542),t.moveTo(o,l),t.lineTo(o+i*Math.cos((h-a)*(Math.PI/180)),l+i*Math.sin((h-a)*(Math.PI/180))),t.moveTo(o,l),t.lineTo(o+i*Math.cos((h+a)*(Math.PI/180)),l+i*Math.sin((h+a)*(Math.PI/180))),t.moveTo(r,s),t.lineTo(o,l)},t.drawFan=function(t,e,n,i,a){},t}();t.GTool=e,__reflect(e.prototype,"lxl.GTool")}(lxl||(lxl={}));var lxl;!function(t){var e=function(){function t(){}return t.getRandomNumByArr=function(t){t.sort(function(t,e){return e-t});for(var e=[],n=0;n<t[0]/10;n/=10){n=10*++n;for(var i=!0,a=0;a<t.length;a++)t[a]==n&&(i=!1);1==i&&e.push(n)}var r=Math.floor(e.length*Math.random())-1;return 0>r&&(r=0),0==e.length?10:e[r]},t.getRandomArrBySortArr=function(t){var e=[],n=Math.random();if(n>.5){for(var i=t.length-1;i>t.length/2;i--)e.push(t[i]);for(var i=t.length/2;i>=0;i--)e.push(t[i]);for(var i=5;i<t.length/2+5;i++){var a=e[i];e[i]=e[e.length/2+5-i],e[e.length/2+5-i]=a}for(var i=t.length/2-5;i<t.length;i++){var a=e[i];e[i]=e[e.length-i],e[e.length-i]=a}for(var i=0;i<t.length/2;i++){var a=e[i];e[i]=e[e.length/2-i],e[e.length/2-i]=a}}else{for(var i=t.length/2;i>=0;i--)e.push(t[i]);for(var i=t.length-1;i>t.length/2;i--)e.push(t[i]);for(var i=0;i<t.length-4;i++){var r=Math.floor(10*Math.random()),a=e[r];e[r]=e[r+2],e[r+2]=a}for(var i=4;i<t.length;i++){var a=e[i];e[i]=e[e.length-i],e[e.length-i]=a}for(var i=t.length/2-5;i<t.length;i++){var a=e[i];e[i]=e[e.length-i],e[e.length-i]=a}}for(var i=0;i<t.length-1;i++){var r=Math.floor(10*Math.random()),a=e[r];e[r]=e[r+2],e[r+2]=a}for(var i=1;3>i;i++){var a=e[i];e[i]=e[e.length-i],e[e.length-i]=a}return e},t.getPointDir=function(t){for(var e=t.length,n=[],i=0;e>i;i++)if(t[i+1]){var a=t[i],r=t[i+1],s=a.y-r.y,o=egret.Point.distance(a,r),l=Math.asin(s/o),h=57.29578*l,c=this.quadrant(a,r),p=this.getDirByAngQuad2(h,c);n.push(p)}var d=this.repDiff(n);return parseInt(d)},t.parseGestureDir=function(t){for(var e=t.length,n=[],i=0;e>i;i++)if(t[i+1]){var a=t[i],r=t[i+1],s=a.y-r.y,o=egret.Point.distance(a,r),l=Math.asin(s/o),h=57.29578*l,c=this.quadrant(a,r),p=this.getDirByAngQuad(h,c);n.push(p)}var d=this.repDiff(n),u=this.sweep(d);return u},t.repDiff=function(t){for(var e="",n=t.length,i=0,a=0;n>a;a++)i!=t[a]&&(i=t[a],e+=t[a]);return e},t.sweep=function(t){for(var e=-1,n=-1,i=this._symbol.length,a=0;i>a;a++){var r=this.Levenshtein_Distance_Percent(this._symbol[a],t);r>n&&(n=r,e=this._symbolG[a])}return.4>n&&(e=-1),e},t.getDirByAngQuad=function(t,e){switch(e){case 1:return 22.5>=t&&t>=0?1:67.5>=t&&t>22.5?8:7;case 2:return 22.5>=t&&t>=0?5:67.5>=t&&t>22.5?6:7;case 3:return-67.5>=t&&t>=-90?3:-22.5>=t&&t>-67.5?4:5;case 4:return-67.5>=t&&t>=-90?3:-22.5>=t&&t>-67.5?2:1}},t.getDirByAngQuad2=function(t,e){switch(e){case 1:return 30>=t&&t>=0?3:60>=t&&t>30?2:1;case 2:return 30>=t&&t>=0?10:60>=t&&t>30?11:12;case 3:return-60>=t&&t>=-90?7:-30>=t&&t>-60?8:9;case 4:return-60>=t&&t>=-90?6:-30>=t&&t>-60?5:4}},t.quadrant=function(t,e){return e.x>=t.x?e.y<=t.y?1:4:e.y<=t.y?2:3},t.Levenshtein_Distance=function(t,e){var n,i,a,r,s,o=t.length,l=e.length,h=[];if(0==o)return l;if(0==l)return o;for(n=0;o>=n;n++)h[n]=[],h[n][0]=n;for(i=0;l>=i;i++)h[0][i]=i;for(n=1;o>=n;n++)for(a=t.charAt(n-1),i=1;l>=i;i++)r=e.charAt(i-1),s=a==r?0:1,h[n][i]=this.Minimum(h[n-1][i]+1,h[n][i-1]+1,h[n-1][i-1]+s);return h[o][l]},t.Levenshtein_Distance_Percent=function(t,e){var n=t.length>e.length?t.length:e.length,i=this.Levenshtein_Distance(t,e);return 1-i/n},t.Minimum=function(t,e,n){return e>t?n>t?t:n:n>e?e:n},t}();e._symbol=["28","46","82","64","141","585","3","7","5","1","4321876","2345678"],e._symbolG=[0,0,3,3,5,5,6,1,7,2,4,4],t.MathUtil=e,__reflect(e.prototype,"lxl.MathUtil")}(lxl||(lxl={}));var lxl;!function(t){var e=function(){function e(){}return e.getNumSp=function(e,n){void 0===n&&(n="");for(var i=new egret.Sprite,a=e.toString().split(""),r=0;r<a.length;r++){var s=t.Tool.createBitmapByName(n+a[r]+"_png");s.x=17*r,i.addChild(s)}return i.width=17*a.length,i.height=40,i},e}();t.NumberUtil=e,__reflect(e.prototype,"lxl.NumberUtil")}(lxl||(lxl={}));var lxl;!function(t){var e=function(){function t(){}return t.formatTimeBySecond=function(t){var e="",n=Math.floor(t/60),i=t%60;return e=this.formatMinite(n)+":"+this.formatSecond(i)},t.formatMinite=function(t){var e="";return 10>t?e="0"+t:60>t?e=""+t:e},t.formatSecond=function(t){var e="";return 10>t?e="0"+t:59>=t?e=""+t:e},t}();t.TimerUtils=e,__reflect(e.prototype,"lxl.TimerUtils")}(lxl||(lxl={}));var lxl;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t._dataHandlers=[],t}return __extends(n,e),n.prototype.disConnect=function(){this._netData&&(this._netData.dispose(),this._netData=null)},n.prototype.close=function(){},n.prototype.setDataConnect=function(e,n){null==this._netData&&(this._netData=new t.data.NetData(this))},n.prototype.addDataHandler=function(e){var n=new t.data.Map;n.k=e.getCode(),n.v=e,null==t.Tool.getValueByKey(this._dataHandlers,e.getCode())&&t.Tool.setMapValue(this._dataHandlers,n)},n.prototype.removeDataHandler=function(e){null!=t.Tool.getValueByKey(this._dataHandlers,e)&&t.Tool.removeMapValue(this._dataHandlers,e)},n.prototype.getDataHandler=function(e){return t.Tool.getValueByKey(this._dataHandlers,e)},n.prototype.handlerPackage=function(e){var n=t.Tool.getValueByKey(this._dataHandlers,e.code());null!=n&&(n.configure(e),n.handlerPackage(null))},n.prototype.send=function(t,e,n){null!=this._netData&&this._netData.send(t,e,n)},n.prototype.handlerSecurityError=function(){},n.prototype.handlerConnect=function(){this.dispatch(new t.CEvent(t.CEvent.CONNECT_SERVER))},n}(t.CDispatcher);t.DataManager=e,__reflect(e.prototype,"lxl.DataManager",["lxl.interfaces.IDataManager"])}(lxl||(lxl={}));